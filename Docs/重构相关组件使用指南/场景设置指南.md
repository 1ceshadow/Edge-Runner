# åœºæ™¯è®¾ç½®æŒ‡å—

æœ¬æŒ‡å—è¯´æ˜å¦‚ä½•åœ¨ Unity åœºæ™¯ä¸­è®¾ç½®æ–°çš„é‡æ„ç³»ç»Ÿã€‚

**âš ï¸ é‡è¦ï¼šæ‰€æœ‰å‚æ•°é…ç½®å¿…é¡»é€šè¿‡ ConfigManager çš„ GameConfig è¿›è¡Œï¼Œç»„ä»¶ä¸å†æ”¯æŒæœ¬åœ°é…ç½®ï¼**

---

## ğŸ“ ç›®å½•

1. [ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](#ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ)
2. [é…ç½®æ¶æ„](#é…ç½®æ¶æ„)
3. [Mainmenu åœºæ™¯è®¾ç½®](#mainmenu-åœºæ™¯è®¾ç½®)
4. [å…³å¡åœºæ™¯è®¾ç½®](#å…³å¡åœºæ™¯è®¾ç½®)
5. [åˆ›å»ºé…ç½®èµ„äº§](#åˆ›å»ºé…ç½®èµ„äº§)
6. [è¿ç§»æ£€æŸ¥æ¸…å•](#è¿ç§»æ£€æŸ¥æ¸…å•)

---

## ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```
Mainmenu åœºæ™¯ï¼ˆå¯åŠ¨åœºæ™¯ï¼‰                    å…³å¡åœºæ™¯ï¼ˆLevel0, Level1...ï¼‰
â”œâ”€â”€ ProjectLifetimeScope â† DontDestroyOnLoad   â”œâ”€â”€ GameLifetimeScope
â”œâ”€â”€ GameManager                                â”œâ”€â”€ Player
â”œâ”€â”€ MusicManager (AudioManager)                â”‚   â”œâ”€â”€ PlayerController â† æ–°çŠ¶æ€æœº
â”œâ”€â”€ ConfigManager â† æ–°å»ºï¼å…¨å±€å•ä¾‹             â”‚   â”œâ”€â”€ PlayerMovement   â† å¯é€‰ä¿ç•™
â”œâ”€â”€ PoolManager   â† æ–°å»ºï¼å…¨å±€å¯¹è±¡æ±            â”‚   â”œâ”€â”€ PlayerCombat
â””â”€â”€ Canvas (UI)                                â”‚   â””â”€â”€ PlayerDeathHandler
                                               â”œâ”€â”€ Main Camera
                                               â”‚   â””â”€â”€ CameraController
                                               â””â”€â”€ Enemies/
                                                   â””â”€â”€ EnemyController[]
```

### ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ

| ç»„ä»¶ | ç”Ÿå‘½å‘¨æœŸ | æ”¾ç½®åœºæ™¯ |
|------|----------|----------|
| `ProjectLifetimeScope` | DontDestroyOnLoad | Mainmenu |
| `ConfigManager` | DontDestroyOnLoad | Mainmenu |
| `PoolManager` | è·¨åœºæ™¯æŒä¹…ï¼ˆå¯é€‰ï¼‰ | Mainmenu æˆ–æ¯ä¸ªå…³å¡ |
| `GameLifetimeScope` | åœºæ™¯çº§ | æ¯ä¸ªå…³å¡ |
| `PlayerController` | åœºæ™¯çº§ | æ¯ä¸ªå…³å¡çš„ Player |

---

## é…ç½®æ¶æ„

### ğŸ”’ å¼ºåˆ¶å…¨å±€é…ç½®

æ‰€æœ‰æ¸¸æˆå‚æ•°**å¿…é¡»**é€šè¿‡ `ConfigManager` çš„ `GameConfig` ScriptableObject é…ç½®ï¼š

```
ConfigManager
â””â”€â”€ GameConfig (ScriptableObject)
    â”œâ”€â”€ PlayerConfig     â† PlayerController è¯»å–
    â”‚   â”œâ”€â”€ MoveSpeed
    â”‚   â”œâ”€â”€ DashDistance
    â”‚   â”œâ”€â”€ MaxEnergy
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ EnemyConfig      â† EnemyController è¯»å–
    â”‚   â”œâ”€â”€ ShootInterval
    â”‚   â”œâ”€â”€ BulletCount
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ BulletConfig     â† PoolableBullet è¯»å–
    â”‚   â”œâ”€â”€ Speed
    â”‚   â”œâ”€â”€ MaxDistance
    â”‚   â””â”€â”€ ...
    â””â”€â”€ PoolConfig       â† PoolManager è¯»å–
        â”œâ”€â”€ BulletPoolSize
        â””â”€â”€ ...
```

### âŒ ç¦æ­¢æœ¬åœ°é…ç½®

ä»¥ä¸‹ç»„ä»¶**ä¸å†æ”¯æŒ**åœ¨ Inspector ä¸­é…ç½®å‚æ•°ï¼š

| ç»„ä»¶ | å¯é…ç½®é¡¹ | ä¸å¯é…ç½®é¡¹ |
|------|----------|-----------|
| `PlayerController` | LayerMask, AudioClip | æ‰€æœ‰æ•°å€¼å‚æ•° |
| `EnemyController` | bulletPrefab, enemyType | æ‰€æœ‰æ•°å€¼å‚æ•° |
| `PoolableBullet` | æ—  | æ‰€æœ‰å‚æ•° |
| `PoolManager` | bulletPrefab | æ± å¤§å° |

---

## Mainmenu åœºæ™¯è®¾ç½®

### 1ï¸âƒ£ åˆ›å»º ConfigManager

```
æ­¥éª¤ï¼š
1. Hierarchy â†’ å³é”® â†’ Create Empty
2. å‘½åä¸º "ConfigManager"
3. Add Component â†’ ConfigManager (EdgeRunner.Config)
4. åœ¨ Inspector ä¸­ï¼Œå°† GameConfig èµ„äº§æ‹–åˆ° "Game Config" å­—æ®µ
```

**æ³¨æ„**ï¼šConfigManager ä¼šè‡ªåŠ¨è®¾ç½®ä¸º `DontDestroyOnLoad`ã€‚

### 2ï¸âƒ£ åˆ›å»º PoolManager

```
æ­¥éª¤ï¼š
1. Hierarchy â†’ å³é”® â†’ Create Empty
2. å‘½åä¸º "PoolManager"
3. Add Component â†’ PoolManager (EdgeRunner.Pooling)
4. è®¾ç½®é…ç½®ï¼š
   - Bullet Prefab: æ‹–å…¥ PoolableBullet é¢„åˆ¶ä½“
   - Bullet Pool Size: 100ï¼ˆæ ¹æ®éœ€æ±‚è°ƒæ•´ï¼‰
   - Bullet Container: å¯ç•™ç©ºï¼ˆä¼šè‡ªåŠ¨åˆ›å»ºï¼‰
```

### 3ï¸âƒ£ åœºæ™¯å±‚çº§ç»“æ„

è®¾ç½®å®Œæˆåï¼ŒMainmenu åœºæ™¯åº”è¯¥å¦‚ä¸‹ï¼š

```
Mainmenu
â”œâ”€â”€ Main Camera
â”œâ”€â”€ Canvas
â”‚   â”œâ”€â”€ StartButton
â”‚   â”œâ”€â”€ SettingsButton
â”‚   â””â”€â”€ ...
â”œâ”€â”€ EventSystem
â”œâ”€â”€ ProjectLifetimeScope    â† VContainer DIï¼ˆå·²æœ‰ï¼‰
â”‚   â”œâ”€â”€ Game State Manager â†’ GameStateManager
â”‚   â””â”€â”€ Audio Manager â†’ AudioManager
â”œâ”€â”€ GameManager             â† æ¸¸æˆçŠ¶æ€ï¼ˆå·²æœ‰ï¼‰
â”œâ”€â”€ MusicManager            â† éŸ³é¢‘ç®¡ç†ï¼ˆå·²æœ‰ï¼‰
â”œâ”€â”€ ConfigManager           â† ã€æ–°å»ºã€‘å…¨å±€é…ç½®
â”‚   â””â”€â”€ Game Config â†’ Assets/Core/Config/GameConfig.asset
â”œâ”€â”€ PoolManager             â† ã€æ–°å»ºã€‘å¯¹è±¡æ± 
â”‚   â””â”€â”€ Bullet Prefab â†’ PoolableBullet
â””â”€â”€ BulletManager           â† ã€å¯ç§»é™¤ã€‘è¢« PoolManager å–ä»£
```

---

## å…³å¡åœºæ™¯è®¾ç½®

### 1ï¸âƒ£ Player GameObject è®¾ç½®

```
Player GameObject ç»„ä»¶åˆ—è¡¨ï¼š
â”œâ”€â”€ Transform
â”œâ”€â”€ Rigidbody2D
â”œâ”€â”€ CircleCollider2D
â”œâ”€â”€ AudioSource
â”œâ”€â”€ SpriteRenderer (æˆ–å­å¯¹è±¡)
â”œâ”€â”€ Animator (å­å¯¹è±¡)
â”œâ”€â”€ Player.cs              â† IPlayerService å®ç°
â”œâ”€â”€ PlayerController.cs    â† ã€æ–°å¢ã€‘çŠ¶æ€æœºæ§åˆ¶å™¨
â”œâ”€â”€ PlayerMovement.cs      â† ã€å¯é€‰ä¿ç•™ã€‘æ—§ç³»ç»Ÿ
â”œâ”€â”€ PlayerCombat.cs        â† è¿‘æˆ˜æ”»å‡»
â”œâ”€â”€ PlayerDeathHandler.cs  â† æ­»äº¡å¤„ç†
â””â”€â”€ PlayerWallCollision.cs â† å¢™ä½“ç¢°æ’ï¼ˆå¦‚æœ‰ï¼‰
```

### 2ï¸âƒ£ æ·»åŠ  PlayerController

```
æ­¥éª¤ï¼š
1. é€‰ä¸­ Player GameObject
2. Add Component â†’ PlayerController (EdgeRunner.Player)
3. é…ç½®é€‰é¡¹ï¼š
   - Use Global Config: âœ…ï¼ˆæ¨èï¼Œä½¿ç”¨ ConfigManager é…ç½®ï¼‰
   - æˆ–å–æ¶ˆå‹¾é€‰ï¼Œä½¿ç”¨ Inspector æœ¬åœ°é…ç½®
4. è®¾ç½®éŸ³æ•ˆï¼š
   - Dash Audio Clip: å†²åˆºéŸ³æ•ˆ
   - Time Slow Start Clip: æ—¶ç¼“å¼€å§‹éŸ³æ•ˆ
   - Time Slow End Clip: æ—¶ç¼“ç»“æŸéŸ³æ•ˆ
```

### 3ï¸âƒ£ å…³äº PlayerMovement

**é—®ï¼šå¯ä»¥ç§»é™¤ PlayerMovement å—ï¼Ÿ**

âœ… **å¯ä»¥**ï¼Œä½†å»ºè®®æ¸è¿›å¼è¿ç§»ï¼š

| æ–¹æ¡ˆ | è¯´æ˜ |
|------|------|
| **æ–¹æ¡ˆ Aï¼šå®Œå…¨è¿ç§»** | ç§»é™¤ `PlayerMovement`ï¼Œå®Œå…¨ä½¿ç”¨ `PlayerController` + çŠ¶æ€æœº |
| **æ–¹æ¡ˆ Bï¼šå¹¶è¡Œè¿è¡Œ** | ä¿ç•™ä¸¤è€…ï¼Œ`PlayerController` å¤„ç†æ–°é€»è¾‘ï¼Œé€æ­¥ç¦ç”¨ `PlayerMovement` |
| **æ–¹æ¡ˆ Cï¼šä¿å®ˆè¿ç§»** | ä¿ç•™ `PlayerMovement`ï¼Œä»…ç”¨ `PlayerController` åšæ‰©å±• |

**å½“å‰çŠ¶æ€**ï¼š`PlayerDeathHandler` å’Œ `EnergyBar` å·²æ”¯æŒä¸¤ç§æ§åˆ¶å™¨ï¼Œå¯ä»¥å®‰å…¨è¿ç§»ã€‚

### 4ï¸âƒ£ å…³å¡åœºæ™¯å±‚çº§ç»“æ„

```
Level0
â”œâ”€â”€ Main Camera
â”‚   â””â”€â”€ CameraController
â”œâ”€â”€ Canvas
â”‚   â””â”€â”€ EnergyBar (å®Œå…¨è§£è€¦ï¼Œä½¿ç”¨äº‹ä»¶)
â”œâ”€â”€ EventSystem
â”œâ”€â”€ GameLifetimeScope       â† VContainer åœºæ™¯ä½œç”¨åŸŸ
â”œâ”€â”€ Player
â”‚   â”œâ”€â”€ PlayerController    â† ã€æ–°å¢ã€‘
â”‚   â”œâ”€â”€ PlayerMovement      â† ã€å¯é€‰ä¿ç•™ã€‘
â”‚   â”œâ”€â”€ PlayerCombat
â”‚   â””â”€â”€ PlayerDeathHandler
â”œâ”€â”€ Environment/
â”‚   â””â”€â”€ ...
â””â”€â”€ Enemies/
    â”œâ”€â”€ Enemy1 (EnemyController)
    â””â”€â”€ Enemy2 (EnemyController)
```

---

## åˆ›å»ºé…ç½®èµ„äº§

### 1ï¸âƒ£ åˆ›å»º GameConfig

```
æ­¥éª¤ï¼š
1. åœ¨ Project çª—å£ï¼Œå¯¼èˆªåˆ° Assets/Core/Config/
2. å³é”® â†’ Create â†’ EdgeRunner â†’ GameConfig
3. å‘½åä¸º "GameConfig"
4. ç‚¹å‡»èµ„äº§ï¼Œåœ¨ Inspector ä¸­é…ç½®æ‰€æœ‰å‚æ•°
```

### 2ï¸âƒ£ GameConfig å‚æ•°è¯´æ˜

```
GameConfig
â”œâ”€â”€ Player (ç©å®¶é…ç½®)
â”‚   â”œâ”€â”€ MoveSpeed: 6.2          â† ç§»åŠ¨é€Ÿåº¦
â”‚   â”œâ”€â”€ RotationSmoothness: 8   â† æ—‹è½¬å¹³æ»‘åº¦
â”‚   â”œâ”€â”€ DashDistance: 3.9       â† å†²åˆºè·ç¦»
â”‚   â”œâ”€â”€ DashCooldown: 0.2       â† å†²åˆºå†·å´
â”‚   â”œâ”€â”€ PerfectDashDetectRange: 1.4
â”‚   â”œâ”€â”€ PerfectDashReward: 8
â”‚   â”œâ”€â”€ TimeSlowScale: 0.3      â† æ—¶ç¼“å€ç‡
â”‚   â”œâ”€â”€ TimeSlowPlayerSpeed: 20
â”‚   â”œâ”€â”€ MaxEnergy: 80           â† æœ€å¤§èƒ½é‡
â”‚   â”œâ”€â”€ EnergyRechargeRate: 2   â† èƒ½é‡å›å¤/ç§’
â”‚   â”œâ”€â”€ EnergyDrainRate: 10     â† æ—¶ç¼“æ¶ˆè€—/ç§’
â”‚   â”œâ”€â”€ MinEnergyThreshold: 10  â† æœ€ä½èƒ½é‡é—¨æ§›
â”‚   â”œâ”€â”€ KillEnergyReward: 10    â† å‡»æ€å¥–åŠ±
â”‚   â””â”€â”€ WallCheckExtra: 0.8     â† å¢™ä½“æ£€æµ‹ç¼“å†²
â”œâ”€â”€ Enemy (æ•Œäººé…ç½®)
â”‚   â”œâ”€â”€ ShootInterval: 1.8
â”‚   â”œâ”€â”€ ShootDistance: 20
â”‚   â”œâ”€â”€ BulletCount: 8
â”‚   â””â”€â”€ ...
â”œâ”€â”€ Bullet (å­å¼¹é…ç½®)
â”‚   â””â”€â”€ ...
â”œâ”€â”€ Camera (ç›¸æœºé…ç½®)
â”‚   â””â”€â”€ ...
â”œâ”€â”€ Audio (éŸ³é¢‘é…ç½®)
â”‚   â””â”€â”€ ...
â””â”€â”€ Pool (å¯¹è±¡æ± é…ç½®)
    â”œâ”€â”€ BulletPoolSize: 100
    â””â”€â”€ ...
```

### 3ï¸âƒ£ åˆ›å»º PoolableBullet é¢„åˆ¶ä½“

```
æ­¥éª¤ï¼š
1. æ‰¾åˆ°ç°æœ‰çš„ Bullet é¢„åˆ¶ä½“
2. å¤åˆ¶ä¸€ä»½ï¼Œå‘½åä¸º "PoolableBullet"
3. ç§»é™¤åŸæœ‰çš„ BulletController
4. æ·»åŠ  PoolableBullet ç»„ä»¶ (EdgeRunner.Pooling)
5. é…ç½®å­å¼¹å±æ€§ï¼ˆé€Ÿåº¦ã€ä¼¤å®³ç­‰ï¼‰
6. ä¿å­˜é¢„åˆ¶ä½“åˆ° Assets/Modules/Bullet/Prefabs/
```

---

## è¿ç§»æ£€æŸ¥æ¸…å•

### Mainmenu åœºæ™¯

- [x] ProjectLifetimeScope å­˜åœ¨ä¸”è®¾ç½®ä¸º DontDestroyOnLoad
- [x] GameStateManager å·²æ³¨å†Œåˆ° ProjectLifetimeScope
- [x] AudioManager å·²æ³¨å†Œåˆ° ProjectLifetimeScope
- [x] **ã€æ–°ã€‘** ConfigManager GameObject å·²åˆ›å»º
- [x] **ã€æ–°ã€‘** ConfigManager å·²å¼•ç”¨ GameConfig èµ„äº§
- [x] **ã€æ–°ã€‘** PoolManager GameObject å·²åˆ›å»º
- [x] **ã€æ–°ã€‘** PoolManager å·²è®¾ç½® bulletPrefab

### å…³å¡åœºæ™¯

- [x] GameLifetimeScope å­˜åœ¨
- [x] Player GameObject å­˜åœ¨
- [x] Player æœ‰ `Player` ç»„ä»¶ï¼ˆIPlayerServiceï¼‰
- [x] **ã€æ–°ã€‘** Player æœ‰ `PlayerController` ç»„ä»¶
- [x] **ã€æ–°ã€‘** PlayerController.useGlobalConfig å·²æ ¹æ®éœ€æ±‚è®¾ç½®
- [x] CameraController å­˜åœ¨ä¸”ä¼šè¢« VContainer æ³¨å…¥
- [x] EnemyController å­˜åœ¨ä¸”ä¼šè¢« VContainer æ³¨å…¥

### é…ç½®èµ„äº§

- [x] **ã€æ–°ã€‘** `Assets/Core/Config/GameConfig.asset` å·²åˆ›å»º
- [x] **ã€æ–°ã€‘** GameConfig æ‰€æœ‰å‚æ•°å·²é…ç½®
- [x] **ã€æ–°ã€‘** `Assets/Modules/Bullet/Prefabs/PoolableBullet.prefab` å·²åˆ›å»º

### è¿è¡ŒéªŒè¯

è¿è¡Œæ¸¸æˆåï¼ŒConsole åº”æ˜¾ç¤ºï¼š

```
âœ“ VContainer: GameStateManager å·²æ³¨å†Œ
âœ“ VContainer: AudioManager å·²æ³¨å†Œ
âœ“ ConfigManager: æ¸¸æˆé…ç½®å·²åŠ è½½
  - ç©å®¶ç§»åŠ¨é€Ÿåº¦: 6.2
  - ç©å®¶å†²åˆºè·ç¦»: 3.9
  - æ•Œäººå°„å‡»é—´éš”: 1.8
  - å­å¼¹æ± å¤§å°: 100
âœ“ PoolManager: å­å¼¹æ± åˆå§‹åŒ–å®Œæˆï¼Œå®¹é‡ 100
âœ“ PlayerController: ä½¿ç”¨ ConfigManager å…¨å±€é…ç½®
âœ“ EnergyBar: ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¨¡å¼
```

---

## å¸¸è§é—®é¢˜

### Q: ConfigManager.Player è¿”å› nullï¼Ÿ

**åŸå› **ï¼šConfigManager æœªåˆå§‹åŒ–æˆ– GameConfig æœªè®¾ç½®ã€‚

**è§£å†³**ï¼š
1. ç¡®è®¤ Mainmenu åœºæ™¯æœ‰ ConfigManager GameObject
2. ç¡®è®¤ ConfigManager çš„ "Game Config" å­—æ®µå·²è®¾ç½®
3. ç¡®è®¤ä» Mainmenu åœºæ™¯å¯åŠ¨æ¸¸æˆ

### Q: PoolManager.Instance è¿”å› nullï¼Ÿ

**åŸå› **ï¼šPoolManager æœªåˆ›å»ºæˆ–è¢«é”€æ¯ã€‚

**è§£å†³**ï¼š
1. ç¡®è®¤ Mainmenu åœºæ™¯æœ‰ PoolManager GameObject
2. æˆ–åœ¨æ¯ä¸ªå…³å¡åœºæ™¯ä¹Ÿåˆ›å»º PoolManagerï¼ˆé DontDestroyOnLoad æ¨¡å¼ï¼‰

### Q: ä½¿ç”¨ PlayerController åè¾“å…¥ä¸å“åº”ï¼Ÿ

**åŸå› **ï¼šPlayerController å’Œ PlayerMovement åŒæ—¶å¯ç”¨ï¼Œè¾“å…¥å†²çªã€‚

**è§£å†³**ï¼š
1. æ–¹æ¡ˆ Aï¼šç¦ç”¨æˆ–ç§»é™¤ PlayerMovement
2. æ–¹æ¡ˆ Bï¼šåªä¿ç•™ä¸€ä¸ªè¾“å…¥å¤„ç†è„šæœ¬

---

## ä¸‹ä¸€æ­¥

è®¾ç½®å®Œæˆåï¼Œå¯ä»¥è¿›ä¸€æ­¥ï¼š

1. **é›†æˆå¯¹è±¡æ± **ï¼šè®© EnemyController ä½¿ç”¨ PoolManager ç”Ÿæˆå­å¼¹
2. **æ‰©å±•çŠ¶æ€æœº**ï¼šæ·»åŠ æ–°çš„ç©å®¶çŠ¶æ€ï¼ˆå¦‚ AttackingStateï¼‰
3. **é…ç½®çƒ­é‡è½½**ï¼šä½¿ç”¨ ConfigManager çš„ç¼–è¾‘å™¨åŠŸèƒ½è¿›è¡Œå®æ—¶è°ƒè¯•

å‚è€ƒæ–‡æ¡£ï¼š
- `EVENT_SYSTEM_GUIDE.md` - äº‹ä»¶ç³»ç»Ÿä½¿ç”¨æŒ‡å—
- `VContaineré‡æ„æŠ¥å‘Š.md` - ä¾èµ–æ³¨å…¥è¯¦ç»†è¯´æ˜
- `README.md` - é‡æ„ç³»ç»Ÿæ€»è§ˆ
