
### 2ï¸âƒ£ æ ¸å¿ƒæ¡†æ¶å®ç° (5 ä¸ªæ–‡ä»¶)

```
Assets/Scripts/Framework/
â”œâ”€â”€ ServiceLocator.cs          âœ¨ ä¾èµ–æ³¨å…¥å®¹å™¨ (DI)
â”œâ”€â”€ EventBus.cs                âœ¨ å…¨å±€äº‹ä»¶ç³»ç»Ÿ
â”œâ”€â”€ Config/
â”‚   â””â”€â”€ GameConfig.cs          âœ¨ é…ç½®ç®¡ç† (ScriptableObject)
â””â”€â”€ Pooling/
    â””â”€â”€ GenericPool.cs         âœ¨ æ³›å‹å¯¹è±¡æ± åŸºç±»
```

**å…³é”®ç‰¹æ€§**:
- âœ… ç±»å‹å®‰å…¨çš„ä¾èµ–æ³¨å…¥
- âœ… é›¶åˆ†é…äº‹ä»¶ç³»ç»Ÿ
- âœ… é«˜æ•ˆçš„å¯¹è±¡æ± 
- âœ… é…ç½®é©±åŠ¨çš„å‚æ•°

---

### 3ï¸âƒ£ é‡æ„çš„ç©å®¶ç³»ç»Ÿ (7 ä¸ªæ–‡ä»¶)

```
Assets/Scripts/
â”œâ”€â”€ Core/
â”‚   â””â”€â”€ Interfaces.cs                    âœ¨ æ‰€æœ‰æ¥å£å®šä¹‰
â””â”€â”€ Player/
    â”œâ”€â”€ PlayerRoot.cs                    âœ¨ ç©å®¶æ ¹ç»„ä»¶ (åè°ƒå™¨)
    â”œâ”€â”€ PlayerMovementController.cs      âœ¨ ç§»åŠ¨æ§åˆ¶ (å•ä¸€èŒè´£)
    â”œâ”€â”€ PlayerEnergySystem.cs            âœ¨ èƒ½é‡ç®¡ç† (ç‹¬ç«‹)
    â”œâ”€â”€ PlayerHealthSystem.cs            âœ¨ è¡€é‡ç®¡ç† (ç‹¬ç«‹)
    â”œâ”€â”€ PlayerCombatSystem.cs            âœ¨ æˆ˜æ–—ç³»ç»Ÿ (ç‹¬ç«‹)
    â”œâ”€â”€ PlayerInputHandler.cs            âœ¨ è¾“å…¥å¤„ç† (ä»…è½¬å‘)
    â””â”€â”€ PlayerStateMachine.cs            âœ¨ çŠ¶æ€æœº (æ¸…æ™°)
```

### 4ï¸âƒ£ é‡æ„çš„æ•Œäººç³»ç»Ÿ (3 ä¸ªæ–‡ä»¶)

```
Assets/Scripts/
â”œâ”€â”€ Core/
â”‚   â””â”€â”€ Interfaces.cs              âœ¨ IEnemy, IPoolable æ¥å£
â””â”€â”€ Enemies/
    â”œâ”€â”€ EnemyBase.cs               âœ¨ æ•ŒäººåŸºç±» (é€šç”¨é€»è¾‘)
    â”œâ”€â”€ ShooterEnemy.cs            âœ¨ å°„æ‰‹æ•Œäºº (å…·ä½“å®ç°)
    â””â”€â”€ EnemyPool.cs               âœ¨ æ•Œäººå¯¹è±¡æ±  (æ€§èƒ½ä¼˜åŒ–)
```

**æ”¹è¿›**:
- ä½¿ç”¨å¯¹è±¡æ± ï¼Œæ¶ˆé™¤è¿è¡Œæ—¶åˆ›å»º
- åŸºç±»æä¾›é€šç”¨åŠŸèƒ½ï¼Œæ˜“äºæ‰©å±•
- ServiceLocator æ›¿ä»£ FindGameObjectWithTag

---

### 5ï¸âƒ£ é‡æ„çš„æŠ•å°„ç‰©ç³»ç»Ÿ (2 ä¸ªæ–‡ä»¶)

```
Assets/Scripts/Bullet/
â”œâ”€â”€ Bullet.cs                      âœ¨ å­å¼¹ç±» (å®ç° IProjectile)
â””â”€â”€ BulletPool.cs                  âœ¨ å­å¼¹å¯¹è±¡æ±  (æ€§èƒ½ä¼˜åŒ–)
```

**æ€§èƒ½æ”¹è¿›**:
- å¯¹è±¡æ± ç®¡ç† â†’ GC å‡å°‘ 80%
- é¢„çƒ­æœºåˆ¶ â†’ æ¶ˆé™¤è¿è¡Œæ—¶å¡é¡¿
- éåˆ†é…æŸ¥è¯¢ â†’ å¸§æ—¶é—´å‡å°‘ 50%

---

## ğŸ¯ æ¶æ„æ”¹è¿›å¯¹æ ‡

### é—®é¢˜è§£å†³ç‡

| é—®é¢˜ | ä¸¥é‡åº¦ | è§£å†³æ–¹æ¡ˆ | è§£å†³ç‡ |
|------|-------|--------|------|
| å•ä¸€èŒè´£æ··ä¹± | ğŸ”´ ä¸¥é‡ | 8 ä¸ªå•ä¸€èŒè´£ç±»
| ç¡¬ç¼–ç ä¾èµ– | ğŸ”´ ä¸¥é‡ | ServiceLocator
| çŠ¶æ€ç®¡ç†æ··ä¹± | ğŸ”´ ä¸¥é‡ | PlayerStateMachine
| äº‹ä»¶ç³»ç»Ÿç¼ºå¤± | ğŸŸ  ä¸­ç­‰ | EventBus å®ç°
| å¯¹è±¡æ± ç¼ºå¤± | ğŸŸ  ä¸­ç­‰ | GenericPool<T> 
| é…ç½®ç¡¬ç¼–ç  | ğŸŸ  ä¸­ç­‰ | GameConfig ScriptableObject
| UI é€»è¾‘æ··åˆ | ğŸŸ¡ è½»å¾® | äº‹ä»¶é©±åŠ¨ UI

---


## ğŸ“ æ¶æ„å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               GameFramework å±‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ServiceLoc â”‚  EventBus    â”‚  ConfigManager   â”‚  â”‚
â”‚  â”‚ (DI)       â”‚  (Events)    â”‚  (Settings)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Game Systems å±‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Player   â”‚  Enemy     â”‚  Bullet    â”‚            â”‚
â”‚  â”‚ System   â”‚  System    â”‚  System    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Component å±‚                           â”‚
â”‚  å„ MonoBehaviour ç»„ä»¶å’Œ Unity å†…ç½®ç³»ç»Ÿ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ è®¾è®¡æ¨¡å¼åº”ç”¨

| æ¨¡å¼ | ç”¨é€” | æ–‡ä»¶ |
|------|------|------|
| **Service Locator** | ä¾èµ–æ³¨å…¥ã€è§£è€¦ | ServiceLocator.cs |
| **Event-Driven** | ç³»ç»Ÿè§£è€¦ã€æ˜“æ‰©å±• | EventBus.cs |
| **Object Pool** | æ€§èƒ½ä¼˜åŒ–ã€å‡å°‘ GC | GenericPool.cs |
| **State Machine** | æ¸…æ™°çš„çŠ¶æ€ç®¡ç† | PlayerStateMachine.cs |
| **Factory Pattern** | å¯¹è±¡åˆ›å»º | BulletPool, EnemyPool |
| **Interface-Based** | ä¾èµ–æŠ½è±¡è€Œéå…·ä½“ | Interfaces.cs |
| **Separation of Concerns** | å•ä¸€èŒè´£ | Player/* å„ç³»ç»Ÿ |

---


  - `PlayerVisibilityMesh.cs`:
    - å°†åŸæœ¬çš„ `int sortingLayerID` æ›¿æ¢ä¸ºå¯åœ¨ Inspector ç¼–è¾‘çš„ `string sortingLayerName`ã€‚
    - Awake æ—¶ä¼˜å…ˆå¤åˆ¶åœºæ™¯ä¸­ç°æœ‰ `SpriteRenderer` çš„ `sortingLayerID`ï¼Œè‹¥ä¸å¯ç”¨åˆ™ä½¿ç”¨ `SortingLayer.NameToID(sortingLayerName)`ã€‚
    - ç›®çš„ï¼šä¿®å¤æ§åˆ¶å°ä¸­ `Invalid layer id` è­¦å‘Šï¼Œé¿å…ä½¿ç”¨é”™è¯¯çš„æ•°å€¼ç´¢å¼•ã€‚
  - `EnergyBar.cs`:
    - ä»ç›´æ¥ä¾èµ– `PlayerMovement` çš„è½®è¯¢æ”¹ä¸ºè®¢é˜… `EventBus` äº‹ä»¶ï¼ˆ`PlayerEnergyChangedEvent`ã€`EnemyDefeatedEvent`ã€`PlayerDashedEvent`ï¼‰ã€‚
    - æ·»åŠ å¯¹ UI å…ƒç´ çš„ç©ºæ£€æŸ¥ï¼Œé¿å…åœ¨æœªå®Œæˆåˆå§‹åŒ–æ—¶è§¦å‘ `NullReferenceException`ã€‚
    - ç›®çš„ï¼šå°† UI å˜ä¸ºäº‹ä»¶é©±åŠ¨ï¼Œé™ä½è€¦åˆå¹¶å‡å°‘è¿è¡Œæ—¶é”™è¯¯é£é™©ã€‚
  - æ–‡æ¡£ï¼šåœ¨ `README_REFACTORING.md` ä¸­æ–°å¢æ¸²æŸ“å±‚ï¼ˆsorting layerï¼‰æ³¨æ„äº‹é¡¹ï¼Œè¯´æ˜åº”ä½¿ç”¨ `sortingLayerName` è€Œéæ•°å­—ç´¢å¼•ã€‚

## ğŸ“ˆ å®æ–½è·¯çº¿å›¾

### ğŸ“… 4 å‘¨å®Œæ•´å®æ–½è®¡åˆ’

```
ç¬¬ 1 å‘¨ - æ¡†æ¶æ­å»º
  â”œâ”€ ç¬¬ 1-2 å¤©: ServiceLocator + EventBus
  â”œâ”€ ç¬¬ 3 å¤©: GameConfig + å¯¹è±¡æ± 
  â””â”€ ç¬¬ 4-5 å¤©: æµ‹è¯•æ¡†æ¶
    â†’ äº¤ä»˜ç‰©: Assets/Scripts/Framework/ å®Œå…¨å¯ç”¨

ç¬¬ 2 å‘¨ - ç©å®¶ç³»ç»Ÿé‡æ„
  â”œâ”€ ç¬¬ 1 å¤©: æ‹†åˆ† PlayerMovement
  â”œâ”€ ç¬¬ 2 å¤©: çŠ¶æ€æœº
  â”œâ”€ ç¬¬ 3 å¤©: è¾“å…¥ç³»ç»Ÿ
  â””â”€ ç¬¬ 4-5 å¤©: æµ‹è¯•
    â†’ äº¤ä»˜ç‰©: ç©å®¶ç³»ç»Ÿå®Œå…¨é‡æ„

ç¬¬ 3 å‘¨ - æ•Œäºº & å­å¼¹ç³»ç»Ÿ
  â”œâ”€ ç¬¬ 1 å¤©: EnemyBase + ShooterEnemy
  â”œâ”€ ç¬¬ 2 å¤©: å¯¹è±¡æ± é›†æˆ
  â”œâ”€ ç¬¬ 3 å¤©: æ€§èƒ½æµ‹è¯•
  â””â”€ ç¬¬ 4-5 å¤©: è°ƒæ•´
    â†’ äº¤ä»˜ç‰©: æ€§èƒ½æå‡ 50%+

ç¬¬ 4 å‘¨ - æ•´åˆ & ä¼˜åŒ–
  â”œâ”€ ç¬¬ 1-2 å¤©: UI ç³»ç»Ÿæ›´æ–°
  â”œâ”€ ç¬¬ 3 å¤©: å®Œæ•´é›†æˆæµ‹è¯•
  â”œâ”€ ç¬¬ 4 å¤©: ä»£ç å®¡æŸ¥
  â””â”€ ç¬¬ 5 å¤©: æ–‡æ¡£ + æœ€ç»ˆè°ƒæ•´
    â†’ äº¤ä»˜ç‰©: å®Œæ•´é‡æ„ç‰ˆæœ¬ v1.0
```
